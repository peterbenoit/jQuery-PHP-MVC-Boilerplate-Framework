(function(a){a.fn.jcaption=function(b){b=a.extend({wrapperElement:"div",wrapperClass:"jcaption",captionElement:"p",imageAttr:"title",copyStyle:true,removeStyle:true,removeAlign:true,removeSpacing:true,copyAlignmentToClass:true,autoWidth:true,animate:false,show:{opacity:"show"},showDuration:200,hide:{opacity:"hide"},hideDuration:200},b);a(this).each(function(){a(this).bind("load",function(){if(a(this).data("loaded")){return false}a(this).data("loaded",true);var e=a(this);if(e.attr(b.imageAttr).length>0){e.wrap("<"+b.wrapperElement+" class='"+b.wrapperClass+"'></"+b.wrapperElement+">");var c=e.attr("style");if(b.removeStyle){e.removeAttr("style")}if(b.removeSpacing){e.removeAttr("vspace");e.removeAttr("hspace")}var d=e.attr("align");if(b.removeAlign){e.removeAttr("align")}var f=a(this).parent().append("<"+b.captionElement+">"+e.attr(b.imageAttr)+"</"+b.captionElement+">");if(b.imageAttr=="alt"){e.removeAttr(b.imageAttr)}if(b.animate){a(this).next().hide();a(this).parent().hover(function(){a(this).find("p").animate(b.show,b.showDuration)},function(){a(this).find("p").animate(b.hide,b.hideDuration)})}if(b.copyStyle){f.attr("style",c)}if(b.copyAlignmentToClass){f.addClass(d)}if(b.autoWidth){f.width(e.width())}}else{if(e.attr("align").length>0){var d=e.attr("align");e.removeAttr("align");e.addClass(d)}}});if(this.complete||this.naturalWidth>0){a(this).trigger("load")}})}})(jQuery);